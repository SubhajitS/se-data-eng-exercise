unit_tests:
  - name: test_able_to_cast_all_columns
    description: "Check if the model is able to cast all columns"
    model: ratings_raw_to_curate
    overrides:
      macros:
        is_incremental: false 
    given:
      - input: source('raw_source', 'ratings_raw')
        format: sql
        rows: |
          select  "108123" as userId, 
                  "1" as movieId, 
                  "0.5" as rating,
                  "1437217185" as timestamp 
          UNION ALL
          select  "10902" as userId, 
                  "2" as movieId, 
                  "0.78" as rating,
                  "1498969154" as timestamp
    expect:
      rows:
        - {
          userId: 108123,
          movieId: 1,
          rating: 0.5,
          timestamp: 2015-07-18 10:59:45-0,
        }
        - {
          userId: 10902,
          movieId: 2,
          rating: 0.78,
          timestamp: 2017-07-02 04:19:14-0,
        }